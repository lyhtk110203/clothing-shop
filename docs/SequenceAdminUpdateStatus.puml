@startuml
' Sequence: Admin updates order status
' Based strictly on OrderController.updateStatus and OrderService.updateStatus

actor Admin
participant "OrderController" as OrderController
participant "OrderService" as OrderService
participant "OrderRepository" as OrderRepo
participant "OrderMapper" as OrderMapper

Admin -> OrderController : PUT /api/orders/{id}/status?status=...
OrderController -> OrderService : updateStatus(id, status)
activate OrderService
OrderService -> OrderRepo : findById(id)
alt not found
  OrderService --> OrderController : throw BusinessException("Order not found")
  deactivate OrderService
  return
else found
  OrderService -> OrderService : order.setStatus(status)
  ' Note: JPA @Transactional on service class ensures persistence context flush/commit
  OrderService -> OrderMapper : toResponse(order)
  OrderService --> OrderController : OrderResponse
  deactivate OrderService
end
OrderController --> Admin : 200 OK (OrderResponse)
@enduml